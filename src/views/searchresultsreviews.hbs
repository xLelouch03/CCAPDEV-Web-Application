{{>navbar}}
    <div class="ctr">
        <div class="row">
            <div class="col-12">
                <h2>Results for "{{searchTerm}}"</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h3>{{resultCount}} results found</h3>
            </div>
        </div>
    
        <div class="row align-items-center">
            <div class="col-sm-6">
                <div class="input-group mb-3">
                    <div class="dropdown rating">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Sort by
                        </button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" id="sortByRating">Rating</button>
                        <button class="dropdown-item" type="button" id="sortByName">Name</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <div class="slide-container">
        {{#each reviews}}
    <div class="review-positioner">
        <div class="review-container">
            <div class="profile-container">
                <img class="profile-picture" src="{{this.user.avatar}}">
                <div class="post-details-container">
                    <span class="profile-name"><a href="./profile1.html" style="color: black; text-decoration: none;">{{this.user.username}}</a></span>
                    <span class="post-date">Last edited: {{this.datePosted}}</span>
                </div>
            </div>
            <div class="review-rating-container">
                <!-- Render the review rating stars based on the 'rating' value -->
                {{#range 1 this.rating 1}}
                    <i class="fa fa-star review-star-icon"></i>
                {{/range}}
            </div>
            <span class="review-title">
                {{this.title}}
            </span>
            <span class="review-content">
                {{this.body}}
                <span class="untruncate-button">Read more</span>
            </span>
            <span class="review-content untruncated-review">
                {{this.body}}
                <span class="truncate-button">Read less</span>
            </span>
            <div class="photo-album">
                {{#each this.images}}
                <img class="photo-album-photo" src="{{this}}">
                {{/each}}
            </div>
            <div class="userbuttons-container">
                <div class="helpful-container">
                    <span class="helpful-icon"></span>
                    <span class="helpful-text">Helpful {{this.likes}}</span>
                    <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    <span class="unhelpful-icon"></span>
                    <span class="helpful-text">Unhelpful {{this.dislikes}}</span>
                </div>
            </div>
        </div>
    </div>
{{/each}}
        
    </div>

<script>


window.onload = function() {
   document.getElementById('sortByRating').addEventListener('click', function() {
      window.location.href = `/searchresult?category=${encodeURIComponent('{{{currentCategory}}}')}&q=${encodeURIComponent('{{{currentQuery}}}')}&sortby=rating`;
   });

   document.getElementById('sortByName').addEventListener('click', function() {
      window.location.href = `/searchresult?category=${encodeURIComponent('{{{currentCategory}}}')}&q=${encodeURIComponent('{{{currentQuery}}}')}&sortby=name`;
   });
}

</script>

